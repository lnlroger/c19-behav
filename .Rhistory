setwd("C:/Users/fores/OneDrive - The University of Nottingham/GitHub/COVID-19")
getwd()
df<-readRDS(here::here("df_covid_long.rds"))%>%
filter(sub_region_1=="")  ###taking the country level average
library(dplyr)
df<-readRDS(here::here("df_covid_long.rds"))%>%
filter(sub_region_1=="")  ###taking the country level average
M<-c(0,-0.95,-0.97,-0.93)
PI<-c(0,0.25,0.5,0.75,1)
M<-c(0,-0.95,-0.97,-0.93,,-0.05,0,-0.3,-0.4,-0.5,-0.55,-0.6)
PI<-c(0,0.25,0.5,0.75,1,0,0.25,0.5,0.75,1)
M<-c(0,-0.95,-0.97,-0.93,,-0.05,0,-0.3,-0.4,-0.5,-0.55,-0.6)
M<-c(0,-0.95,-0.97,-0.93,-0.05,0,-0.3,-0.4,-0.5,-0.55,-0.6)
M<-c(0,-0.95,-0.97,-0.93,-0.95,0,-0.3,-0.4,-0.5,-0.55)
PI<-c(0,0.25,0.5,0.75,1,0,0.25,0.5,0.75,1)
C<-c(rep("Country1",5),rep("Country2",5))
df<-as.data.frame(cbind(M,PI,C))
stat_cor(method = "pearson", size=5,label.y=c(0.1),label.sep = "\n")+
theme_bw()
df%>%
ggplot(aes(x=PI,y=M,color=C))+
geom_point(size=3,alpha=0.5)+
stat_cor(method = "pearson", size=5,label.y=c(0.1),label.sep = "\n")+
theme_bw()
library(tidyverse)
df%>%
ggplot(aes(x=PI,y=M,color=C))+
geom_point(size=3,alpha=0.5)+
stat_cor(method = "pearson", size=5,label.y=c(0.1),label.sep = "\n")+
theme_bw()
df%>%
ggplot(aes(x=PI,y=M,color=C))+
geom_point(size=3,alpha=0.5)
df%>%
ggplot(aes(x=PI,y=M,color=C))+
geom_point(size=3,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.y=c(0.1),label.sep = "\n")+
theme_bw()
??stat_cor
library(ggpubr)
df%>%
ggplot(aes(x=PI,y=M,color=C))+
geom_point(size=3,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.y=c(0.1),label.sep = "\n")+
theme_bw()
df%>%
ggplot(aes(x=PI,y=M,color=C))+
geom_point(size=3,alpha=0.5)+
stat_smooth(method="lm")
df%>%
ggplot(aes(x=PI,y=M,color=C))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.y=c(0.1),label.sep = "\n")+
theme_bw()
df%>%
ggplot(aes(x=PI,y=M,color=C))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.y=c(-0.1),label.sep = "\n")+
theme_bw()
df%>%
ggplot(aes(x=PI,y=M,color=C))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
theme_bw()
df%>%
ggplot(aes(x=PI,y=M,color=C))+
geom_point(size=4,alpha=0.5)+
stat_smooth()+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
theme_bw()
df%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
face_wrap(~C)+
theme_bw()
df%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
facet_wrap(~C)+
theme_bw()
df%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson")+
facet_wrap(~C)+
theme_bw()
df%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")
?stat_smooth
M1<-c(0,seq(-0.95,-1,0.01)
M1<-c(0,seq(-0.95,-1,0.01))
seq(0,1,0.01)
M1<-c(0,seq(-0.95,-1,-0.01))
M1<-c(0,seq(-0.75,-1,-0.01))
M2<-c(0,seq(-0.25,-0.75,-0.02))
M<-rbind(M1,M2)
M1<-c(0,seq(-0.75,-0.98,-0.01))
M2<-c(0,seq(-0.25,-0.73,-0.02))
M1<-c(0,seq(-0.75,-0.98,-0.01))
M2<-c(0,seq(-0.25,-0.72,-0.02))
M<-rbind(M1,M2)
PI<-(rep(seq(0,1,0.4)),2)
seq(0,1,0.4))
PI<-rep(seq(0,1,0.4),2)
PI<-rep(seq(0,1,0.04),2)
PI<-rep(seq(0,0.96,0.04),2)
C<-c(rep("Country1",25),rep("Country2",25))
df<-as.data.frame(cbind(M,PI,C))
M<-c(M1,M2)
df<-as.data.frame(cbind(M,PI,C))
df%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
facet_wrap(~C)+
theme_bw()
M<-c(0,-0.95,-0.97,-0.93,-0.95,0,-0.3,-0.4,-0.5,-0.55)
PI<-c(0,0.25,0.5,0.75,1,0,0.25,0.5,0.75,1)
C<-c(rep("Country1",5),rep("Country2",5))
df<-as.data.frame(cbind(M,PI,C))
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
face_wrap(~C)+
theme_bw()
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
facet_wrap(~C)+
theme_bw()
df%>%
group_by(C,M,PI)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
facet_wrap(~C)+
theme_bw()
class(df$M)
class(M)
df<-cbind(M,PI,C)
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
facet_wrap(~C)+
theme_bw()
d<-as.data.frame(df)
class(d$M)
class(d$PI)
d<-as.numeric(as.data.frame(df))
df<-cbind(M,PI,C)
df
d<-as.data.frame(df)
df<-as.data.frame()
df$Movement<-M
M<-c(0,-0.95,-0.97,-0.93,-0.95,0,-0.3,-0.4,-0.5,-0.55)
PI<-c(0,0.25,0.5,0.75,1,0,0.25,0.5,0.75,1)
C<-c(rep("Country1",5),rep("Country2",5))
df$Movement<-M
df<-as.data.frame()
df<-data.frame()
df$Movement<-M
df<-data.frame(nrow=10,ncol=3)
df$Movement<-M
df<-data.frame()
df<-data.frame(M,PI,C)
class(df$M)
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
facet_wrap(~C)+
theme_bw()
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
stat_cor(method = "lm", size=5,label.sep = "\n")+
facet_wrap(~C)+
theme_bw()
?stat_cor
library(ggpmisc)
install.packages("ggpmisc")
install.packages("ggpmisc")
library(ggpmisc)
my.formula <- y ~ x
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
#stat_cor(method = "pearson", size=5,label.sep = "\n")+
stat_poly_eq(formula = my.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
facet_wrap(~C)+
theme_bw()
M<-c(0,-0.95,-0.97,-0.93,-0.93,-0.93,-0.93,-0.93,-0.93,-0.95,0,-0.3,-0.4,-0.5,-0.55)
M<-c(0,-0.95,-0.97,-0.93,-0.93,-0.93,-0.93,-0.93,-0.93,-0.95,0,-0.3,-0.4,-0.5,-0.5,-0.51,-0.52,-0.53,-0.54,-0.55)
PI<-rep(seq(0,1,0.05))
PI<-rep(seq(0,0.95,0.05))
C<-c(rep("Country1",10),rep("Country2",10))
df<-data.frame(M,PI,C)
my.formula <- y ~ x
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
#stat_cor(method = "pearson", size=5,label.sep = "\n")+
stat_poly_eq(formula = my.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
facet_wrap(~C)+
theme_bw()
PI<-rep(seq(0,0.95,0.05),2)
PI<-rep(seq(0,0.95,0.1),2)
C<-c(rep("Country1",10),rep("Country2",10))
df<-data.frame(M,PI,C)
my.formula <- y ~ x
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
#stat_cor(method = "pearson", size=5,label.sep = "\n")+
stat_poly_eq(formula = my.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
facet_wrap(~C)+
theme_bw()
getwd()
ggsave("compliance_eg.png")
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=5,label.sep = "\n")+
stat_poly_eq(formula = my.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
facet_wrap(~C)+
theme_bw()
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson", size=3)+
stat_poly_eq(formula = my.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
facet_wrap(~C)+
theme_bw()
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson",label.y=c(-0.1), size=3)+
stat_poly_eq(formula = my.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
facet_wrap(~C)+
theme_bw()
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson",label.y=c(-0.25), size=4)+
stat_poly_eq(formula = my.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
facet_wrap(~C)+
theme_bw()
df%>%
group_by(C)%>%
ggplot(aes(x=PI,y=M))+
geom_point(size=4,alpha=0.5)+
stat_smooth(method="lm")+
stat_cor(method = "pearson",label.y=c(-1.25), size=4)+
stat_poly_eq(formula = my.formula,
aes(label = paste(..eq.label.., ..rr.label.., sep = "~~~")),
parse = TRUE) +
facet_wrap(~C)+
theme_bw()
ggsave("compliance_eg.png")
